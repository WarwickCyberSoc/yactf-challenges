comms = """464ee15e33bf207c066a9f
223c96262de86a36313ac16f7fed7d2b326e933130eb3270687eaa7e15fe7c64667fc16c6ca521776660eb
464ee15e2db26a360f44b6177fed7d2b561ce44930eb32700c0cdd0615fe7c64020db6146da526750212b82c
6b3c96262db26a366b36c16f7fed7d2b326e933130eb32647779aa7e15fe7c64667fc16c6ca52177663d893b33f318
464ee10b72b23f694611b6177fed7d2b1f1ce44930eb32765e08dd061bfa7164590db6176fa522704b48fb5637e8601b3405c9543cfe71211948b8563af218
34218e7f55b23f694611b6177fed7d2b1f1ce44930eb32765e08dd061bfa7164590db6176fa522704b48fb5637e8601b3405c9543cfe71211948b8563af218
404efa1e33bf23767f2bb6177fed7d2b1f1ce44930eb32765e08dd061bfa7164590db6176fa522704b48fb5637e8601b3405c9543cfe71211948b8563af218
243c8d662db26a366d36da2c7fed7d2b346e887130eb32706e7eb13e15fe7c64607fda2c6da5277c6060f05637e8601b3405c9543cfe71211948b8563af218
404efa1e2db26a360944ad577fed7d2b501cff0930eb32700a0cc64615fe7c64040dad546da5277c0412a36c37e8601b3405c9543cfe71211948b8563af2186d3c8d332db23f366d63da2f7fed7d2b346e887130eb3264607cc23e15fe7c64607fda2c6da5277c602c9b7034c07136252a89302be7664e1948b8563af218
1953f95233bf207c5977872f7fed7d2b346e887130eb3264607cc23e15fe7c64607fda2c6da5277c602c9b7034c07136252a89302be7664e1948b8563af218
7d218e2a2de86a366e27d9637fed7d2b6d738b3d30eb32703763b27215fe7c643962d9606ca52177397df37034c07136252a89302be7664e1948b8563af218
1953f9522db26a365059ae1b7fed7d2b0901fc4530eb32705311c50a15fe7c645d10ae186da526755d0fa02034c07136252a89302be7664e1948b8563af218
34218e2a2db26a36342bd9637fed7d2b6d738b3d30eb32642864b27215fe7c643962d9606ca521773920913733f31836252a89302be7664e1948b8563af218
1953f90772b23f69190cae1b7fed7d2b4001fc4530eb32760115c50a1bfa71640610ae1b6fa522701455e35a37e8601b6b18d1583cfe71214655a05a3af218
4e1ebe7c1cea2773293ea6753ae957162c36a63217da5e08266cc67a1bfa71640610ae1b6fa522701455e35a37e8601b6b18d1583cfe71214655a05a3af218
3a71ca1d33bf207c7a55b4753ae957162c36a63217da5e08266cc67a1bfa71640610ae1b6fa522701455e35a37e8601b6b18d1583cfe71214655a05a3af218
5e03bd652de86a364d05ea2c7fed7d2b4e51b87230eb32701441813d15fe7c641a40ea2f6ca521771a5fc05a37e8601b6b18d1583cfe71214655a05a3af218
3a71ca1d2db26a36737b9d547fed7d2b2a23cf0a30eb32707033f64515fe7c647e329d576da526757e2d936f37e8601b6b18d1583cfe71214655a05a3af218
1703bd652db26a361709ea2c7fed7d2b4e51b87230eb32640b46813d15fe7c641a40ea2f6ca521771a02a27833f3181b6b18d1583cfe71214655a05a3af218
3a71ca4872b23f693a2e9d547fed7d2b6323cf0a30eb32762237f6451bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
481ea53c65b528750248f27965af287d0348f37165a8287e
2c7fc05130f1286e722f9d0567ae287472279c0566a6287372249f361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
4e16ae6b75a5237c1547f16b6fa52b7d1546f96b68a5287e26249f361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af2183d6fdd5175a5237c772e9f516fa52b7d772f975168a5287e44249f361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af2184e16b33265b528750556e56065af287d0456e46865a8287e07659f361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af2182977de572ca5387e7f2e8a0a6ea5227e772f8a0b66a5257e742cb9361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af2184416b06d75a5237c104fef6d6fa52b7d104ee76d68a5287e232cb9361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af21828668a4765ae2a7d7c278a5d65a62b7d7d2f8a5a65a5284e232cb9361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
4507e32b65b52875105fb27665af287d115fb37e65a8287e126cb9361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
2b62945865b528757d3edb1a65af287d7c3eda1265a8287e7f0db9361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
5e17f72865b52875135bac6965af287d125bad6165a8287e1168b9361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
2e65985026a5387e6f2fce106ea5227e672ece1166a5257e642dfd361bfa716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
5912ef7d3bfe6625144fa26167a62a751455a26966a62b7d1452a26a6595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
3b738c162aef286e6323d74467ae2874632bd64466a628736328d5776595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
571aff6265b52875034ab42765af287d024ab52f65a8287e0179d5776595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
3e689c5875a5237c6e22ce586fa52b7d6e23c65868a5287e5d79d5776595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
5906fd2c2ca5387e0f50a5606ea5227e0751a56166a5257e045296776595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
37699f433be6286e6337c51567ae2874633fc41566a62873633cc7266595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
6808ef3765b528750f50a77265af287d0e50a67a65a8287e0d63c7266595716425329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
056d9c443ef877261d7bd51d65ae2a7d513bd50765a62b7d5131d5
710eec202af2627e2f57ad7c66a6217e3557a57d66a62b7e3257a67e55a5284e25329d546fa522703777d01537e8601b483ae2173cfe7121657793153af218
"""

initial_encrypt = [0x32, 0x21, 0x95, 0x3F, 0x5F, 0x9F, 0x12, 0x44]

add_value = 0

for line in comms.splitlines():
    # person, data = line.split(":")
    person = "B"
    data = bytes.fromhex(line)
    if person == "A":
        print("Attacker ran", data)
    else:
        decrypted = b""
        for index, byte in enumerate(data):
            decrypted += bytes([byte ^ initial_encrypt[index % 8]])

        print(decrypted)

        if len(decrypted) > 4:
            for i in range(4):
                initial_encrypt[i] = data[i]
